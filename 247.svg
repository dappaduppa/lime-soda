<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">


<!-- Page 247 -->
<svg x="0" y="0" width="909" height="1286" viewBox="0 0 909 1286" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
style="display: block;margin-left: auto;margin-right: auto;">
<defs>

<style type="text/css"><![CDATA[


.s1_247{
font-size: 30.81px;
font-family: LiberationSerif-Bold_b;
fill: #8E0012;
}
.s2_247{
font-size: 22.01px;
font-family: LiberationSerif_e;
fill: #000000;
}
.s3_247{
font-size: 22.01px;
font-family: LiberationSerif-Italic_l;
fill: #000000;
}
.s4_247{
font-size: 17.60px;
font-family: LiberationMono_1q;
fill: #000000;
}
.s5_247{
font-size: 13.20px;
font-family: LiberationMono-Bold_1w;
fill: #006699;
}
.s6_247{
font-size: 13.20px;
font-family: LiberationMono_1q;
fill: #CC00FF;
}
.s7_247{
font-size: 13.20px;
font-family: LiberationMono_1q;
fill: #000000;
}
.s8_247{
font-size: 13.20px;
font-family: LiberationMono_1q;
fill: #000088;
}
.s9_247{
font-size: 13.20px;
font-family: LiberationMono-Italic_10;
fill: #CC3300;
}
.s10_247{
font-size: 13.20px;
font-family: LiberationMono_1q;
fill: #336666;
}
.s11_247{
font-size: 13.20px;
font-family: LiberationMono_1q;
fill: #FF6600;
}
.s12_247{
font-size: 13.20px;
font-family: LiberationMono-Bold_1w;
fill: #000000;
}

]]></style>

</defs>
<path d="M0,0
L0,1286
L909,1286
L909,0 Z " 
fill="#FFFFFF" stroke="none" />
<text 
x="55" 
y="81" 
class="s1_247"
>The Model</text>

<text 
x="55" 
y="122" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.8,-1.2" 
class="s2_247"
>Recall that we were investigating the relationship between a DataSciencester user’s</text>

<text 
x="55" 
y="149" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.4,0,0,0,0,0,-1.2,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>number of friends and the amount of time he spent on the site each day. Let’s assume that</text>

<text 
x="55" 
y="177" 
class="s2_247"
>you’ve convinced yourself that having more friends</text>

<text 
x="515" 
y="177" 
class="s3_247"
>causes</text>

<text 
x="580" 
y="177" 
class="s2_247"
>people to spend more time on</text>

<text 
x="55" 
y="204" 
class="s2_247"
>the site, rather than one of the alternative explanations we discussed.</text>

<text 
x="55" 
y="243" 
dx="0,0,0,0,0,0,0,-0.8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>The VP of Engagement asks you to build a model describing this relationship. Since you</text>

<text 
x="55" 
y="270" 
class="s2_247"
>found a pretty strong linear relationship, a natural place to start is a linear model.</text>

<text 
x="55" 
y="316" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,-0.9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>In particular, you hypothesize that there are constants</text>

<image preserveAspectRatio="none" x="530" y="303" width="18" height="14" xlink:href="247/img/1.png" />
<text 
x="552" 
y="316" 
class="s2_247"
>(alpha) and</text>

<image preserveAspectRatio="none" x="658" y="288" width="16" height="29" xlink:href="247/img/2.png" />
<text 
x="679" 
y="316" 
class="s2_247"
>(beta) such that:</text>

<image preserveAspectRatio="none" x="55" y="334" width="451" height="71" xlink:href="247/img/3.png" />
<text 
x="55" 
y="436" 
class="s2_247"
>where</text>

<image preserveAspectRatio="none" x="114" y="416" width="19" height="21" xlink:href="247/img/4.png" />
<text 
x="138" 
y="436" 
class="s2_247"
>is the number of minutes user</text>

<text 
x="404" 
y="436" 
class="s3_247"
>i</text>

<text 
x="416" 
y="436" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1.4" 
class="s2_247"
>spends on the site daily,</text>

<image preserveAspectRatio="none" x="631" y="417" width="19" height="20" xlink:href="247/img/5.png" />
<text 
x="655" 
y="436" 
class="s2_247"
>is the number of</text>

<text 
x="55" 
y="464" 
class="s2_247"
>friends user</text>

<text 
x="163" 
y="464" 
class="s3_247"
>i</text>

<text 
x="175" 
y="464" 
class="s2_247"
>has, and</text>

<image preserveAspectRatio="none" x="253" y="445" width="18" height="19" xlink:href="247/img/6.png" />
<text 
x="275" 
y="464" 
class="s2_247"
>is a (hopefully small) error term representing the fact that there</text>

<text 
x="55" 
y="491" 
class="s2_247"
>are other factors not accounted for by this simple model.</text>

<text 
x="55" 
y="530" 
class="s2_247"
>Assuming we’ve determined such an</text>

<text 
x="385" 
y="530" 
class="s4_247"
>alpha</text>

<text 
x="443" 
y="530" 
class="s2_247"
>and</text>

<text 
x="480" 
y="530" 
class="s4_247"
>beta</text>

<text 
x="523" 
y="530" 
class="s2_247"
>, then we make predictions simply</text>

<text 
x="55" 
y="560" 
class="s2_247"
>with:</text>

<text 
x="76" 
y="605" 
class="s5_247"
>def</text>

<text 
x="108" 
y="605" 
class="s6_247"
>predict</text>

<text 
x="163" 
y="605" 
class="s7_247"
>(</text>

<text 
x="171" 
y="605" 
class="s8_247"
>alpha</text>

<text 
x="211" 
y="605" 
class="s7_247"
>,</text>

<text 
x="227" 
y="605" 
class="s8_247"
>beta</text>

<text 
x="258" 
y="605" 
class="s7_247"
>,</text>

<text 
x="274" 
y="605" 
class="s8_247"
>x_i</text>

<text 
x="298" 
y="605" 
class="s7_247"
>):</text>

<text 
x="108" 
y="620" 
class="s5_247"
>return</text>

<text 
x="163" 
y="620" 
class="s8_247"
>beta</text>

<text 
x="203" 
y="620" 
class="s7_247"
>*</text>

<text 
x="219" 
y="620" 
class="s8_247"
>x_i</text>

<text 
x="250" 
y="620" 
class="s7_247"
>+</text>

<text 
x="266" 
y="620" 
class="s8_247"
>alpha</text>

<text 
x="55" 
y="673" 
class="s2_247"
>How do we choose</text>

<text 
x="228" 
y="673" 
class="s4_247"
>alpha</text>

<text 
x="286" 
y="673" 
class="s2_247"
>and</text>

<text 
x="323" 
y="673" 
class="s4_247"
>beta</text>

<text 
x="366" 
y="673" 
dx="0,0,0,-1.8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>? Well, any choice of</text>

<text 
x="557" 
y="673" 
class="s4_247"
>alpha</text>

<text 
x="615" 
y="673" 
class="s2_247"
>and</text>

<text 
x="652" 
y="673" 
class="s4_247"
>beta</text>

<text 
x="700" 
y="673" 
class="s2_247"
>gives us a</text>

<text 
x="55" 
y="703" 
class="s2_247"
>predicted output for each input</text>

<text 
x="331" 
y="703" 
class="s4_247"
>x_i</text>

<text 
x="363" 
y="703" 
class="s2_247"
>. Since we know the actual output</text>

<text 
x="666" 
y="703" 
class="s4_247"
>y_i</text>

<text 
x="703" 
y="703" 
class="s2_247"
>we can compute</text>

<text 
x="55" 
y="732" 
class="s2_247"
>the error for each pair:</text>

<text 
x="76" 
y="777" 
class="s5_247"
>def</text>

<text 
x="108" 
y="777" 
class="s6_247"
>error</text>

<text 
x="148" 
y="777" 
class="s7_247"
>(</text>

<text 
x="156" 
y="777" 
class="s8_247"
>alpha</text>

<text 
x="195" 
y="777" 
class="s7_247"
>,</text>

<text 
x="211" 
y="777" 
class="s8_247"
>beta</text>

<text 
x="242" 
y="777" 
class="s7_247"
>,</text>

<text 
x="258" 
y="777" 
class="s8_247"
>x_i</text>

<text 
x="282" 
y="777" 
class="s7_247"
>,</text>

<text 
x="298" 
y="777" 
class="s8_247"
>y_i</text>

<text 
x="322" 
y="777" 
class="s7_247"
>):</text>

<text 
x="108" 
y="793" 
dx="0,0,0,0,0,0,0,4.6,0,0,0,0,0,4.6,0,0,0,0,4.6,0,0,0,0,0,0,0,0,0,0,4.6,0,0,0,0,4.6,0,4.6,0,0,0,4.6,0,4.6,0,0,0,0" 
class="s9_247"
>"""the error from predicting beta * x_i + alpha</text>

<text 
x="108" 
y="808" 
dx="0,0,0,0,0,4.6,0,0,0,4.6,0,0,0,0,0,0,4.6,0,0,0,0,0,4.6,0,0,4.6,0,0,0,0,0" 
class="s9_247"
>when the actual value is y_i"""</text>

<text 
x="108" 
y="824" 
class="s5_247"
>return</text>

<text 
x="163" 
y="824" 
class="s8_247"
>y_i</text>

<text 
x="195" 
y="824" 
class="s7_247"
>-</text>

<text 
x="211" 
y="824" 
class="s8_247"
>predict</text>

<text 
x="266" 
y="824" 
class="s7_247"
>(</text>

<text 
x="274" 
y="824" 
class="s8_247"
>alpha</text>

<text 
x="314" 
y="824" 
class="s7_247"
>,</text>

<text 
x="329" 
y="824" 
class="s8_247"
>beta</text>

<text 
x="361" 
y="824" 
class="s7_247"
>,</text>

<text 
x="377" 
y="824" 
class="s8_247"
>x_i</text>

<text 
x="401" 
y="824" 
class="s7_247"
>)</text>

<text 
x="55" 
y="876" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.4,0,0,0,0,0" 
class="s2_247"
>What we’d really like to know is the total error over the entire data set. But we don’t want</text>

<text 
x="55" 
y="904" 
class="s2_247"
>to just add the errors — if the prediction for</text>

<text 
x="445" 
y="904" 
class="s4_247"
>x_1</text>

<text 
x="482" 
y="904" 
class="s2_247"
>is too high and the prediction for</text>

<text 
x="776" 
y="904" 
class="s4_247"
>x_2</text>

<text 
x="813" 
y="904" 
class="s2_247"
>is</text>

<text 
x="55" 
y="934" 
dx="0,0,0,0,0,0,0,-1.4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>too low, the errors may just cancel out.</text>

<text 
x="55" 
y="972" 
class="s2_247"
>So instead we add up the</text>

<text 
x="279" 
y="972" 
dx="0,0,0,0,0,-0.8,0" 
class="s3_247"
>squared</text>

<text 
x="355" 
y="972" 
class="s2_247"
>errors:</text>

<text 
x="76" 
y="1017" 
class="s5_247"
>def</text>

<text 
x="108" 
y="1017" 
class="s6_247"
>sum_of_squared_errors</text>

<text 
x="274" 
y="1017" 
class="s7_247"
>(</text>

<text 
x="282" 
y="1017" 
class="s8_247"
>alpha</text>

<text 
x="322" 
y="1017" 
class="s7_247"
>,</text>

<text 
x="337" 
y="1017" 
class="s8_247"
>beta</text>

<text 
x="369" 
y="1017" 
class="s7_247"
>,</text>

<text 
x="385" 
y="1017" 
class="s8_247"
>x</text>

<text 
x="393" 
y="1017" 
class="s7_247"
>,</text>

<text 
x="408" 
y="1017" 
class="s8_247"
>y</text>

<text 
x="416" 
y="1017" 
class="s7_247"
>):</text>

<text 
x="108" 
y="1033" 
class="s5_247"
>return</text>

<text 
x="163" 
y="1033" 
class="s10_247"
>sum</text>

<text 
x="187" 
y="1033" 
class="s7_247"
>(</text>

<text 
x="195" 
y="1033" 
class="s8_247"
>error</text>

<text 
x="235" 
y="1033" 
class="s7_247"
>(</text>

<text 
x="242" 
y="1033" 
class="s8_247"
>alpha</text>

<text 
x="282" 
y="1033" 
class="s7_247"
>,</text>

<text 
x="298" 
y="1033" 
class="s8_247"
>beta</text>

<text 
x="329" 
y="1033" 
class="s7_247"
>,</text>

<text 
x="345" 
y="1033" 
class="s8_247"
>x_i</text>

<text 
x="369" 
y="1033" 
class="s7_247"
>,</text>

<text 
x="385" 
y="1033" 
class="s8_247"
>y_i</text>

<text 
x="408" 
y="1033" 
dx="0,0,4.6,0" 
class="s7_247"
>) **</text>

<text 
x="448" 
y="1033" 
class="s11_247"
>2</text>

<text 
x="195" 
y="1048" 
class="s5_247"
>for</text>

<text 
x="227" 
y="1048" 
class="s8_247"
>x_i</text>

<text 
x="250" 
y="1048" 
class="s7_247"
>,</text>

<text 
x="266" 
y="1048" 
class="s8_247"
>y_i</text>

<text 
x="298" 
y="1048" 
class="s12_247"
>in</text>

<text 
x="322" 
y="1048" 
class="s10_247"
>zip</text>

<text 
x="345" 
y="1048" 
class="s7_247"
>(</text>

<text 
x="353" 
y="1048" 
class="s8_247"
>x</text>

<text 
x="361" 
y="1048" 
class="s7_247"
>,</text>

<text 
x="377" 
y="1048" 
class="s8_247"
>y</text>

<text 
x="385" 
y="1048" 
class="s7_247"
>))</text>

<text 
x="55" 
y="1101" 
class="s2_247"
>The</text>

<text 
x="94" 
y="1101" 
dx="0,0,0,0,0,0,0,0,0,0,0,-0.8,0,0,0,0,0,0,0,0,0,0" 
class="s3_247"
>least squares solution</text>

<text 
x="291" 
y="1101" 
class="s2_247"
>is to choose the</text>

<text 
x="432" 
y="1101" 
class="s4_247"
>alpha</text>

<text 
x="491" 
y="1101" 
class="s2_247"
>and</text>

<text 
x="528" 
y="1101" 
class="s4_247"
>beta</text>

<text 
x="575" 
y="1101" 
class="s2_247"
>that make</text>

<text 
x="55" 
y="1131" 
class="s4_247"
>sum_of_squared_errors</text>

<text 
x="282" 
y="1131" 
class="s2_247"
>as small as possible.</text>

<text 
x="55" 
y="1171" 
dx="0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0" 
class="s2_247"
>Using calculus (or tedious algebra), the error-minimizing alpha and beta are given by:</text>

<text 
x="76" 
y="1216" 
class="s5_247"
>def</text>

<text 
x="108" 
y="1216" 
class="s6_247"
>least_squares_fit</text>

<text 
x="242" 
y="1216" 
class="s7_247"
>(</text>

<text 
x="250" 
y="1216" 
class="s8_247"
>x</text>

<text 
x="258" 
y="1216" 
class="s7_247"
>,</text>

<text 
x="274" 
y="1216" 
class="s8_247"
>y</text>

<text 
x="282" 
y="1216" 
class="s7_247"
>):</text>



<!-- Any embedded fonts defined here -->
<style type="text/css" ><![CDATA[

@font-face {
	font-family: LiberationSerif-Italic_l;
	src: url("fonts/LiberationSerif-Italic_l.woff") format("woff");
}

@font-face {
	font-family: LiberationMono-Bold_1w;
	src: url("fonts/LiberationMono-Bold_1w.woff") format("woff");
}

@font-face {
	font-family: LiberationMono_1q;
	src: url("fonts/LiberationMono_1q.woff") format("woff");
}

@font-face {
	font-family: LiberationMono-Italic_10;
	src: url("fonts/LiberationMono-Italic_10.woff") format("woff");
}

@font-face {
	font-family: LiberationSerif-Bold_b;
	src: url("fonts/LiberationSerif-Bold_b.woff") format("woff");
}

@font-face {
	font-family: LiberationSerif_e;
	src: url("fonts/LiberationSerif_e.woff") format("woff");
}

]]></style>

</svg>
